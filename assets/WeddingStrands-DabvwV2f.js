import{j as s,_ as pe}from"./index-oJkx2L23.js";import{b as n}from"./vendor-BO-UU5I_.js";import{u as ve}from"./runtime.module-CxOLQiBe.js";import{C as we,H as ke}from"./CompletionModal-D9ACBJVh.js";const ae=n.memo(({letter:p,row:c,col:d,isSelected:v,isInFound:y,isInSpangram:h,isTapMode:W,onCellClick:m,onCellMouseDown:f,onCellMouseEnter:N,onCellTouchStart:G,setButtonRef:E})=>{const T=()=>m(c,d),L=()=>f(c,d),P=()=>N(c,d),R=w=>G(c,d,w);return s.jsx("button",{ref:w=>E(c,d,w),"data-row":c,"data-col":d,onClick:T,onMouseDown:L,onMouseEnter:P,onTouchStart:R,className:`
        w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16
        flex items-center justify-center
        rounded-full font-bold text-lg sm:text-xl md:text-2xl
        transition-all duration-200
        ${v?"bg-blue-500 text-white scale-95":h?"bg-nyt-yellow text-gray-900":y?"bg-nyt-beige-dark text-white":"bg-nyt-beige-light hover:bg-gray-300 dark:hover:bg-gray-600 text-gray-900"}
        cursor-pointer select-none
      `,style:{touchAction:W?"auto":"none"},children:p})});ae.displayName="StrandsCell";const Se=pe(()=>import("./strands-puzzle-BCaaOBSk.js"),[]).then(p=>p.default||p),B="wedding-strands-progress";function Me(){const p=n.use(Se),[c,d]=n.useState([]),v=n.useMemo(()=>p.grid,[p]),y=n.useMemo(()=>p.words,[p]),[h,W]=n.useState([]),m=ve(""),[f,N]=n.useState(!1),[G,E]=n.useState(!1),[T,L]=n.useState(0),[P,R]=n.useState(!1),[w,I]=n.useState(!1),[K,oe]=n.useState(!1),[k,X]=n.useState(!1),S=n.useRef(null),Y=n.useRef(null),Z=n.useRef({}),Q=n.useRef(!0),z=n.useRef(null),F=n.useRef({centers:{},rects:{}}),[le,ee]=n.useState(!1);n.useEffect(()=>{localStorage.getItem("wedding-strands-how-to-play")||(ee(!0),localStorage.setItem("wedding-strands-how-to-play","true"))},[]);const H=n.useRef(c),M=n.useRef(w),j=n.useRef(k),D=n.useRef(f),te=n.useRef(h);n.useEffect(()=>{H.current=c},[c]),n.useEffect(()=>{M.current=w},[w]),n.useEffect(()=>{j.current=k},[k]),n.useEffect(()=>{D.current=f},[f]),n.useEffect(()=>{te.current=h},[h]);const _=()=>{if(!Y.current)return;const e=Y.current.getBoundingClientRect(),t={},r={};v.forEach((o,a)=>{o.forEach((i,u)=>{const l=A(a,u),g=Z.current[l];if(g){const x=g.getBoundingClientRect();r[l]=x,t[l]={x:x.left-e.left+x.width/2,y:x.top-e.top+x.height/2}}})}),F.current={centers:t,rects:r}};n.useEffect(()=>(_(),window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)),[]),n.useEffect(()=>{const e=localStorage.getItem(B);if(e)try{const t=JSON.parse(e);W(t.foundWords||[]),L(t.elapsedTime||0),N(t.isComplete||!1),t.foundWords&&t.foundWords.length===y.length&&N(!0)}catch(t){console.error("Failed to parse save state:",t),localStorage.removeItem(B)}},[]),n.useEffect(()=>{if(Q.current){Q.current=!1;return}localStorage.setItem(B,JSON.stringify({foundWords:h,elapsedTime:T,isComplete:f}))},[h,T,f]),n.useEffect(()=>{const e=()=>{document.hidden?R(!1):f||R(!0)};return f||R(!0),document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e),S.current&&clearInterval(S.current)}},[f]),n.useEffect(()=>(P&&!f?S.current=setInterval(()=>{L(e=>e+1)},1e3):S.current&&clearInterval(S.current),()=>{S.current&&clearInterval(S.current)}),[P,f]);const se=e=>{const t=Math.floor(e/60),r=e%60;return`${t}:${r.toString().padStart(2,"0")}`},A=(e,t)=>`${e}-${t}`,ie=(e,t)=>{const r=Math.abs(e.row-t.row),o=Math.abs(e.col-t.col);return r<=1&&o<=1&&!(r===0&&o===0)},ce=(e,t)=>e.length!==t.positions.length?!1:e.every((r,o)=>{const[a,i]=t.positions[o];return r.row===a&&r.col===i}),C=n.useCallback((e,t)=>h.some(r=>{const o=y.find(a=>a.word===r);return o?o.positions.some(([a,i])=>a===e&&i===t):!1}),[h]),b=n.useCallback((e,t,r,o,a)=>{if(C(t,r))return null;if(e.some(l=>l.key===o))return e.length>0&&e[e.length-1].key===o?e.slice(0,-1):e;if(e.length===0)return[{row:t,col:r,key:o,letter:a}];const u=e[e.length-1];return ie(u,{row:t,col:r})?[...e,{row:t,col:r,key:o,letter:a}]:null},[C]),$=n.useCallback(()=>{const e=H.current;if(e.length<3){m.value="Word too short!",setTimeout(()=>m.value="",2e3),d([]);return}const t=e.map(a=>a.letter).join(""),r=y.find(a=>a.word===t||ce(e,a)),o=te.current;if(r&&!o.includes(r.word)){const a=[...o,r.word];W(a),m.value=r.isSpangram?"üéâ Spangram found!":"Great job!",a.length===y.length&&(N(!0),E(!0)),setTimeout(()=>m.value="",2e3)}else o.includes(t)?(m.value="Already found!",setTimeout(()=>m.value="",2e3)):(m.value="Not in word list or Invalid word!",setTimeout(()=>m.value="",2e3));d([])},[]),de=n.useCallback((e,t)=>{if(D.current||!j.current)return;const r=A(e,t),o=v[e][t];d(a=>{const i=b(a,e,t,r,o);return i||(a.some(l=>l.key===r)||(m.value="Must select adjacent letters!",setTimeout(()=>m.value="",1500)),a)})},[b]),ue=n.useCallback((e,t)=>{if(D.current||j.current||C(e,t))return;I(!0);const r=A(e,t),o=v[e][t];d(a=>a.some(l=>l.key===r)?a:b(a,e,t,r,o)||a)},[C,b]),me=n.useCallback((e,t)=>{if(!M.current||D.current||j.current)return;const r=A(e,t),o=v[e][t];d(a=>a.some(l=>l.key===r)||a.length===0?a:b(a,e,t,r,o)||a)},[b]),q=n.useCallback(()=>{M.current&&(H.current.length>=3&&$(),I(!1))},[$]),fe=n.useCallback((e,t,r)=>{if(D.current||j.current||C(e,t))return;z.current=Date.now(),I(!0),_();const o=A(e,t),a=v[e][t];d(i=>i.some(g=>g.key===o)?i:b(i,e,t,o,a)||i)},[C,b]),he=n.useCallback((e,t,r)=>{r&&(Z.current[A(e,t)]=r)},[]),J=n.useCallback(e=>{if(!M.current||D.current||j.current)return;e.preventDefault(),e.stopPropagation();const t=e.touches[0];if(!t)return;const{rects:r}=F.current,o=t.clientX,a=t.clientY;let i=null;for(const u in r){const l=r[u];if(o>=l.left&&o<=l.right&&a>=l.top&&a<=l.bottom){const[g,x]=u.split("-").map(Number);i={row:g,col:x,key:u};break}}if(i){const{row:u,col:l,key:g}=i,x=v[u][l];d(O=>O.some(be=>be.key===g)?O:b(O,u,l,g,x)||O)}},[b]),U=n.useCallback(e=>{j.current||M.current&&((z.current?Date.now()-z.current:0)>150&&H.current.length>=3&&setTimeout(()=>{$()},50),I(!1),z.current=null)},[]),V=n.useCallback(e=>{M.current&&(I(!1),d([]),z.current=null)},[]);n.useEffect(()=>(document.addEventListener("mouseup",q),document.addEventListener("touchend",U,{passive:!0}),document.addEventListener("touchcancel",V,{passive:!0}),document.addEventListener("touchmove",J,{passive:!1}),()=>{document.removeEventListener("mouseup",q),document.removeEventListener("touchend",U),document.removeEventListener("touchcancel",V),document.removeEventListener("touchmove",J)}),[q,U,V,J]);const ge=()=>{d([])},ne=()=>{localStorage.removeItem(B),d([]),W([]),m.value="",N(!1),E(!1),L(0),R(!0)},xe=()=>{E(!1)},ye=(e,t)=>c.some(r=>r.row===e&&r.col===t),re=()=>y.filter(e=>!h.includes(e.word));return s.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-4 sm:py-8 px-3 sm:px-4",children:[s.jsx(we,{isOpen:G,icon:"üíç",message:"You found all the words!",primaryButtonText:"New Game",secondaryButtonText:"Show Puzzle",onPrimaryAction:ne,onSecondaryAction:xe,primaryButtonGradient:"from-yellow-400 to-blue-500",stats:[{label:"Time",value:se(T),gradient:"from-yellow-100 to-blue-100 dark:from-yellow-900/30 dark:to-blue-900/30"}]}),s.jsx(ke,{isOpen:le,onClose:()=>ee(!1),children:s.jsxs("ul",{className:"space-y-2",children:[s.jsx("li",{children:"‚Ä¢ Find all the hidden wedding-themed words."}),s.jsx("li",{children:"‚Ä¢ Drag across adjacent letters to form words."}),s.jsx("li",{children:"‚Ä¢ Look for the special spangram that spans across the puzzle (marked with ‚≠ê)"}),s.jsx("li",{children:"‚Ä¢ Try to find all words as quickly as possible!"})]})}),s.jsxs("div",{className:"w-full max-w-[min(96vw,650px)] mx-auto",children:[s.jsxs("header",{className:"text-center mb-6 sm:mb-8",children:[s.jsx("h1",{className:"text-responsive-h1 font-bold mb-2 text-gray-900 dark:text-gray-100",children:"Strands"}),s.jsx("p",{className:"text-responsive-h2 text-gray-600 dark:text-gray-300",children:" Wedding Edition"}),s.jsx("p",{className:"text-responsive-sm text-gray-500 dark:text-gray-400 mt-2",children:"Find the hidden words! ‚Ä¢ Drag to select letters ‚Ä¢ Find the pangram!"})]}),s.jsxs("div",{className:"flex justify-between items-center mb-4 px-2",children:[s.jsx("div",{className:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-gray-100",children:se(T)}),s.jsxs("div",{className:"text-base sm:text-lg font-semibold text-gray-700 dark:text-gray-300",children:[h.length," / ",y.length]})]}),!f&&s.jsx("div",{className:"flex justify-center mb-4",children:s.jsxs("div",{className:"bg-white border-2 border-gray-300 rounded-full p-1 inline-flex",children:[s.jsx("button",{onClick:()=>X(!1),className:`px-4 sm:px-6 py-2 rounded-full font-semibold transition-colors text-responsive-base ${k?"bg-white text-gray-700 hover:bg-gray-100":"bg-gray-900 text-white"}`,children:"Drag Mode"}),s.jsx("button",{onClick:()=>X(!0),className:`px-4 sm:px-6 py-2 rounded-full font-semibold transition-colors text-responsive-base ${k?"bg-gray-900 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:"Tap Mode"})]})}),s.jsx("div",{className:"mb-6 flex justify-center",children:s.jsxs("div",{className:"relative inline-block",ref:Y,style:{touchAction:k?"auto":"none"},children:[s.jsx("svg",{className:"absolute inset-0 pointer-events-none",style:{zIndex:1},width:"100%",height:"100%",children:c.length>1&&c.map((e,t)=>{if(t===0)return null;const r=c[t-1],o=F.current.centers[r.key],a=F.current.centers[e.key];return!o||!a?null:s.jsx("line",{x1:o.x,y1:o.y,x2:a.x,y2:a.y,stroke:"#3b82f6",strokeWidth:"4",strokeLinecap:"round"},`path-${t}`)})}),s.jsx("div",{className:"relative",style:{zIndex:2},children:v.map((e,t)=>s.jsx("div",{className:"flex gap-2.5 sm:gap-3 mb-2.5 sm:mb-3",children:e.map((r,o)=>{const a=ye(t,o),i=C(t,o),u=y.find(g=>g.isSpangram),l=h.includes(u?.word)&&u?.positions.some(([g,x])=>g===t&&x===o);return s.jsx(ae,{letter:r,row:t,col:o,isSelected:a,isInFound:i,isInSpangram:l,isTapMode:k,onCellClick:de,onCellMouseDown:ue,onCellMouseEnter:me,onCellTouchStart:fe,setButtonRef:he},`${t}-${o}`)})},t))})]})}),c.length>0&&s.jsx("div",{className:"text-center mb-4",children:s.jsx("div",{className:"text-lg sm:text-xl font-bold text-gray-900 dark:text-gray-100",children:c.map(e=>e.letter).join("")})}),m.value&&s.jsx("div",{className:"text-center mb-4 font-semibold text-base sm:text-lg text-gray-900 dark:text-gray-100",children:m.value}),!f&&s.jsxs("div",{className:"flex flex-wrap justify-center gap-6 sm:gap-8 mb-6",children:[s.jsx("button",{onClick:ge,className:"btn-control text-responsive-base",disabled:c.length===0,children:"Clear"}),s.jsx("button",{onClick:$,className:`btn-control text-responsive-base ${c.length>=3?"!bg-gray-900 dark:!bg-gray-200 !text-white dark:!text-gray-900 hover:!bg-gray-700 dark:hover:!bg-gray-100":"opacity-50 cursor-not-allowed"}`,disabled:c.length<3,children:"Submit"}),s.jsxs("button",{onClick:()=>oe(!K),className:"btn-control text-responsive-base",children:[K?"Hide":"Show"," Hints"]})]}),f&&s.jsxs("div",{className:"flex justify-center gap-6 sm:gap-8",children:[s.jsx("button",{onClick:ne,className:"btn-primary bg-gradient-to-r from-yellow-400 to-blue-500 text-responsive-base",children:"New Game"}),s.jsx("button",{onClick:()=>E(!0),className:"btn-secondary text-responsive-base",children:"Show Time"})]}),s.jsxs("div",{className:"mt-8 p-4 sm:p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[s.jsx("h2",{className:"text-responsive-h2 font-bold mb-3 text-gray-900 dark:text-gray-100",children:"Found Words"}),s.jsx("div",{className:"space-y-2",children:h.map((e,t)=>{const r=y.find(o=>o.word===e);return s.jsxs("div",{className:`
                    px-3 py-2 rounded-lg font-semibold text-responsive-base
                    ${r?.isSpangram?"bg-nyt-yellow text-gray-900":"bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100"}
                  `,children:[e," ",r?.isSpangram&&"‚≠ê Spangram"]},t)})}),K&&re().length>0&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[s.jsx("h3",{className:"font-semibold mb-2 text-gray-900 dark:text-gray-100 text-responsive-base",children:"Remaining Word Hints:"}),s.jsx("ul",{className:"space-y-1 text-gray-600 dark:text-gray-300 text-responsive-base",children:re().map((e,t)=>s.jsxs("li",{children:["‚Ä¢ ",e.hint," ",e.isSpangram&&"(Spangram)"]},t))})]})]}),s.jsxs("div",{className:"mt-8 p-4 sm:p-6 bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[s.jsx("h2",{className:"text-responsive-h2 font-bold mb-3 text-gray-900 dark:text-gray-100",children:"How to Play"}),s.jsxs("ul",{className:"space-y-2 text-gray-700 dark:text-gray-300 text-responsive-base",children:[s.jsx("li",{children:"‚Ä¢ Drag across adjacent letters to form words."}),s.jsx("li",{children:"‚Ä¢ Find all the hidden wedding-themed words."}),s.jsx("li",{children:"‚Ä¢ Look for the special spangram word (marked with ‚≠ê)."}),s.jsx("li",{children:"‚Ä¢ The spangram spans across the puzzle."}),s.jsx("li",{children:"‚Ä¢ Try to find all words as quickly as possible!"})]})]})]})]})}export{Me as default};
